<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stocked | Meal Planner</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%235C8D89' d='M96 0C60.7 0 32 28.7 32 64V96c0 16.4 6.1 31.4 16.2 43.2C40.3 151.1 35.1 164.5 33 179c-3.7 26.3 15.1 50.7 41.5 54.4l5.5 .8V384c0 70.7 57.3 128 128 128h160c70.7 0 128-57.3 128-128V234.2l5.5-.8c26.3-3.7 45.1-28 41.5-54.4c-2.1-14.5-7.3-27.9-15.2-39.8C473.9 127.4 480 112.4 480 96V64c0-35.3-28.7-64-64-64H96zM416 96H96V64h320v32zM96 384V219.8l-10.8-7.2c-10.8-7.2-16.4-20.2-14.3-33c2.2-13.1 13.5-22.6 26.8-22.6H414.3c13.3 0 24.6 9.5 26.8 22.6c2.2 12.8-3.5 25.8-14.3 33l-10.8 7.2V384c0 35.3-28.7 64-64 64H160c-35.3 0-64-28.7-64-64z'/%3E%3C/svg%3E">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loader"><i class="fas fa-spinner fa-spin"></i></div>
    <div id="toast" class="toast">Action Successful</div>

    <nav>
        <div class="nav-brand"><i class="fas fa-utensils"></i> Stocked</div>
        <div class="nav-center" id="nav-actions" style="display:none;">
            <div class="nav-tabs">
                <button class="active" onclick="switchTab('dashboard')">Dashboard</button>
                <button onclick="switchTab('planning')">Planner</button>
                <button onclick="switchTab('substitutions')">Conversions</button>
            </div>
        </div>
        
        <div class="nav-right" id="user-section" style="display:none;">
            <span class="user-greeting" id="user-greeting"></span>
            
            <button class="nav-icon-btn" id="btn-global-save" onclick="saveAllData()" title="Force Save">
                <i class="fas fa-save"></i>
            </button>

            <button class="nav-icon-btn" id="btn-friends-nav" onclick="switchTab('friends')" title="Friends">
                <i class="fas fa-user-friends"></i>
            </button>

            <div style="position:relative;">
                <button class="nav-icon-btn settings-btn" onclick="toggleSettingsMenu()">
                    <i class="fas fa-cog"></i>
                </button>
                <div id="settings-dropdown" class="settings-dropdown">
                    <div class="settings-item" onclick="openProfileModal()">
                        <i class="fas fa-user"></i> Profile
                    </div>
                    <div class="settings-item" onclick="toggleDarkMode()">
                        <i class="fas fa-moon"></i> Dark Mode
                        <i id="dark-mode-icon" class="fas fa-toggle-off" style="margin-left:auto; color:var(--text-light);"></i>
                    </div>
                    <div class="settings-item danger" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="mobile-nav-bar" id="mobile-nav" style="display:none;">
        <button class="mobile-nav-item active" onclick="switchTab('dashboard')">
            <i class="fas fa-th-large"></i><span>Recipes</span>
        </button>
        <button class="mobile-nav-item" onclick="switchTab('planning')">
            <i class="fas fa-calendar-alt"></i><span>Plan</span>
        </button>
        <button class="mobile-nav-item" onclick="switchTab('friends')">
            <i class="fas fa-user-friends"></i><span>Friends</span>
        </button>
        <button class="mobile-nav-item" onclick="switchTab('substitutions')">
            <i class="fas fa-calculator"></i><span>Tools</span>
        </button>
    </div>

    <div class="container" id="main-content" style="display:none;">
        <section id="dashboard" class="page-section active">
            <br>
            <div class="search-row">
                <i class="fas fa-search"></i>
                <input type="text" id="recipe-search" placeholder="Search recipes by name..." oninput="handleSearch(this.value)">
                <button class="btn-clear-search" id="clear-search-btn" onclick="clearSearch()"><i class="fas fa-times"></i></button>
            </div>
            <div class="filter-row">
                <div class="filter-scroll" id="dashboard-filters"></div>
                <span id="total-recipe-count" class="recipe-count-badge"></span>
                <button class="btn-manage-cats" onclick="openCatManager()"><i class="fas fa-pencil-alt"></i></button>
            </div>
            
            <div id="recipe-grid" class="recipe-grid"></div>
            <button class="fab" onclick="openModal()"><i class="fas fa-plus"></i></button>
        </section>

        <section id="friends" class="page-section">
            <br>
            <div class="header-row">
                <h2>Friends</h2>
                <button class="btn-sm" onclick="openAddFriendModal()"><i class="fas fa-user-plus"></i> Add Friend</button>
            </div>
            <div id="friends-list-container"></div>
        </section>

        <section id="friend-cookbook" class="page-section">
            <br>
            <div class="header-row">
                <h2 id="friend-cookbook-title">Friend's Cookbook</h2>
                <button class="btn-sm" onclick="switchTab('friends')"><i class="fas fa-arrow-left"></i> Back</button>
            </div>
            <div id="friend-recipe-grid" class="recipe-grid"></div>
        </section>

        <section id="planning" class="page-section">
            <br>
            <div class="header-row">
                <h2>Weekly Plan</h2>
                <button class="btn-sm" onclick="clearWeeklyPlan()"><i class="fas fa-trash-alt"></i> Clear Week</button>
            </div>
            
            <div class="planner-grid">
                <div class="planner-labels-column">
                    <div class="day-header" style="border:none;"></div> <div class="meal-row-label"><i class="fas fa-coffee"></i>Break</div>
                    <div class="meal-row-label"><i class="fas fa-hamburger"></i>Lunch</div>
                    <div class="meal-row-label small"><i class="fas fa-drumstick-bite"></i>Dinner</div>
                    <div class="meal-row-label small"><i class="fas fa-bread-slice"></i>Side</div>
                </div>

                <div class="day-column">
                    <div class="day-header">Mon</div>
                    <div class="meal-slot" data-day="0" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="0" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="0" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="0" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Tue</div>
                    <div class="meal-slot" data-day="1" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="1" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="1" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="1" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Wed</div>
                    <div class="meal-slot" data-day="2" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="2" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="2" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="2" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Thu</div>
                    <div class="meal-slot" data-day="3" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="3" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="3" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="3" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Fri</div>
                    <div class="meal-slot" data-day="4" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="4" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="4" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="4" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Sat</div>
                    <div class="meal-slot" data-day="5" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="5" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="5" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="5" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
                <div class="day-column">
                    <div class="day-header">Sun</div>
                    <div class="meal-slot" data-day="6" data-type="break" data-label="Break" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="6" data-type="lunch" data-label="Lunch" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="6" data-type="dinner-main" data-label="Dinner" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                    <div class="meal-slot" data-day="6" data-type="dinner-side" data-label="Side" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
            </div>

            <div class="tools-section">
                <div class="tool-card">
                    <div class="header-row"><h3><i class="fas fa-carrot"></i> Ingredients on Hand</h3></div>
                    <div id="inventory-list-container" class="inventory-container"></div>
                    <div class="inventory-add-row">
                        <div class="custom-select-container" id="inv-cat-select">
                            <select id="new-item-category">
                                <option value="Produce">Produce</option><option value="Meat & Protein">Meat & Protein</option><option value="Dairy & Fridge">Dairy & Fridge</option><option value="Pantry & Grains">Pantry & Grains</option><option value="Spices & Seasonings">Spices</option>
                            </select>
                        </div>
                        <input type="text" id="new-inventory-item" placeholder="Add item...">
                        <button onclick="addInventoryItem()"><i class="fas fa-plus"></i></button>
                    </div>
                </div>

                <div class="tool-card">
                    <div class="header-row">
                        <h3><i class="fas fa-shopping-basket"></i> Grocery List</h3>
                        <button class="btn-sm" id="btn-copy-list" onclick="copyGroceryList()"><i class="far fa-copy"></i> Copy</button>
                    </div>
                    <div id="grocery-list-output" class="grocery-container"></div>
                    <div class="inventory-add-row" style="border-top: 1px dashed var(--border); padding-top: 1.5rem;">
                        <div class="custom-select-container" id="groc-cat-select">
                            <select id="manual-grocery-category">
                                <option value="Produce">Produce</option><option value="Meat & Protein">Meat & Protein</option><option value="Dairy & Fridge">Dairy & Fridge</option><option value="Pantry & Grains">Pantry & Grains</option><option value="Spices & Seasonings">Spices</option><option value="Other">Other</option>
                            </select>
                        </div>
                        <input type="text" id="manual-grocery-item" placeholder="Add extra item...">
                        <button onclick="addManualGroceryItem()"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <section id="substitutions" class="page-section">
            <br>
            <div class="header-row">
                <h2>Conversions & Substitutions</h2>
            </div>
            <div class="tools-section">
                <div class="tool-card">
                    <h3><i class="fas fa-calculator"></i> Common Conversions</h3>
                    <ul class="sub-list">
                        <li><span class="sub-original">3 teaspoons</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 tablespoon</span></li>
                        <li><span class="sub-original">4 tablespoons</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1/4 cup</span></li>
                        <li><span class="sub-original">16 tablespoons</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 cup</span></li>
                        <li><span class="sub-original">1 cup</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">8 fluid ounces</span></li>
                        <li><span class="sub-original">1 pint</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">2 cups</span></li>
                        <li><span class="sub-original">1 quart</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">2 pints</span></li>
                        <li><span class="sub-original">1 gallon</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">4 quarts</span></li>
                    </ul>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-cookie-bite"></i> Baking & Pantry</h3>
                    <ul class="sub-list">
                        <li><span class="sub-original">1 tsp Baking Powder</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1/4 tsp Baking Soda + 1/2 tsp Cream of Tartar</span></li>
                        <li><span class="sub-original">1 oz Chocolate</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">3 tbsp Cocoa + 1 tbsp Shortening</span></li>
                        <li><span class="sub-original">1 tbsp Corn Starch</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">2 tbsp Flour</span></li>
                        <li><span class="sub-original">1 cup Cake Flour</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">7/8 cup All Purpose + 2 tbsp Cornstarch</span></li>
                        <li><span class="sub-original">1 cup Brown Sugar</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">3/4 cup White Sugar + 1/4 cup Molasses</span></li>
                        <li><span class="sub-original">1 cup Powdered Sugar</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 cup White Sugar (blended)</span></li>
                    </ul>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-cheese"></i> Dairy & Fridge</h3>
                    <ul class="sub-list">
                        <li><span class="sub-original">1 cup Butter</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 cup Margarine</span></li>
                        <li><span class="sub-original">1 cup Buttermilk</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 tbsp Vinegar + Milk (to 1 cup)</span></li>
                        <li><span class="sub-original">1 cup Cream</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1/2 cup Butter + 3/4 cup Milk</span></li>
                        <li><span class="sub-original">1 Whole Egg</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">2 Egg Yolks</span></li>
                        <li><span class="sub-original">1 cup Sour Cream</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 cup Yogurt</span></li>
                    </ul>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-pepper-hot"></i> Savory & Misc</h3>
                    <ul class="sub-list">
                        <li><span class="sub-original">1 clove Garlic</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1/8 tsp Garlic Powder</span></li>
                        <li><span class="sub-original">1 tbsp Fresh Herbs</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 tsp Dried</span></li>
                        <li><span class="sub-original">1 tbsp Mustard</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 tsp Dry Mustard</span></li>
                        <li><span class="sub-original">1 Onion</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1 tbsp Onion Powder</span></li>
                        <li><span class="sub-original">1/2 cup Wine</span><i class="fas fa-arrow-right sub-arrow"></i><span class="sub-replacement">1/4 cup Vinegar + 1 tbsp Sugar + Water</span></li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <div id="add-friend-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row">
                <h2>Add Friend</h2>
                <button class="modal-close-btn" onclick="closeAddFriendModal()"><i class="fas fa-times"></i></button>
            </div>
            <p style="color:var(--text-light); margin-bottom:1rem; font-size:0.9rem;">Enter your friend's email address to add them. They must have saved their profile at least once.</p>
            <div class="inventory-add-row" style="margin-bottom: 1rem;">
                <input type="email" id="friend-email-input" placeholder="friend@example.com">
                <button onclick="addFriend()"><i class="fas fa-user-plus"></i></button>
            </div>
            <div id="add-friend-msg"></div>
        </div>
    </div>

    <div id="confirm-modal" class="modal-overlay">
        <div class="modal" style="max-width: 400px; text-align: center;">
            <h2 class="confirm-title" style="margin-bottom: 1rem; color: var(--danger);">Are you sure?</h2>
            <p id="confirm-message" style="color: var(--text-light); margin-bottom: 2rem; font-size: 1rem;"></p>
            <div class="modal-actions" style="justify-content: center; gap: 1rem; margin-top: 0;">
                <button class="secondary" onclick="closeConfirmModal()">Cancel</button>
                <button id="confirm-yes-btn" class="danger">Yes, I'm sure</button>
            </div>
        </div>
    </div>

    <div id="alert-modal" class="modal-overlay">
        <div class="modal" style="max-width: 400px; text-align: center;">
            <div style="margin-bottom: 1rem; font-size: 3rem; color: var(--accent);"><i class="fas fa-exclamation-circle"></i></div>
            <h2 class="confirm-title" style="margin-bottom: 1rem; color: var(--text-main);">Missing Details</h2>
            <p id="alert-message" style="color: var(--text-light); margin-bottom: 2rem; font-size: 1rem;"></p>
            <div class="modal-actions" style="justify-content: center; margin-top: 0;">
                <button class="primary" onclick="closeAlertModal()">Got it</button>
            </div>
        </div>
    </div>

    <div id="auth-modal" class="modal-overlay open">
        <div class="modal">
            <h2 id="auth-title" class="auth-title">Welcome to Stocked</h2>
            <p style="color:var(--text-light); margin-bottom:1.5rem;">Login to save your recipes and plans.</p>
            <div id="auth-error"></div>
            <div id="auth-name-container" style="display:none; gap:10px; margin-bottom:1.2rem;">
                 <div style="flex:1;">
                     <label style="display:block; margin-bottom:0.6rem; font-weight:600; font-size:0.85rem; text-transform:uppercase; color:var(--text-light); letter-spacing:0.5px;">First Name</label>
                     <input type="text" id="auth-first" placeholder="Jane" style="width:100%;">
                 </div>
                 <div style="flex:1;">
                     <label style="display:block; margin-bottom:0.6rem; font-weight:600; font-size:0.85rem; text-transform:uppercase; color:var(--text-light); letter-spacing:0.5px;">Last Name</label>
                     <input type="text" id="auth-last" placeholder="Doe" style="width:100%;">
                 </div>
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="email" id="auth-email" placeholder="you@example.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <div class="password-wrapper">
                    <input type="password" id="auth-password" placeholder="••••••••">
                    <i class="fas fa-eye password-toggle" onclick="togglePasswordVisibility()"></i>
                </div>
            </div>
            <button id="auth-btn" class="primary" style="width:100%; margin-top:1rem;">Log In</button>
            <div class="auth-toggle" onclick="toggleAuthMode()">Don't have an account? Sign Up</div>
        </div>
    </div>

    <div id="profile-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row">
                <h2>Your Profile</h2>
                <button class="modal-close-btn" onclick="closeProfileModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="form-group">
                <label>First Name</label>
                <input type="text" id="profile-first" placeholder="e.g. Braden">
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" id="profile-last" placeholder="e.g. Smith">
            </div>
            <div class="modal-actions">
                <button class="primary" onclick="saveProfile()">Save & Make Discoverable</button>
            </div>
        </div>
    </div>

    <div id="cat-manager-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row">
                <h2>Manage Categories</h2>
                <button class="modal-close-btn" onclick="closeCatManager()"><i class="fas fa-times"></i></button>
            </div>
            <div style="margin-bottom: 1rem;">
                <label style="display:block; margin-bottom:0.5rem; font-weight:600; font-size:0.85rem; text-transform:uppercase; color:var(--text-light);">New Category</label>
                <div id="color-picker-container" class="color-picker-row"></div>
            </div>
            <div class="inventory-add-row" style="margin-bottom: 1rem;">
                <input type="text" id="new-cat-name" placeholder="Category Name (e.g. Thai)">
                <button onclick="addNewCategory()"><i class="fas fa-plus"></i></button>
            </div>
            <hr style="border:0; border-top:1px solid var(--border); margin:1.5rem 0;">
            <p style="font-size:0.85rem; color:var(--text-light); margin-bottom:0.5rem;">Current Categories (Click color to edit)</p>
            <ul id="manage-cat-list" class="cat-list">
            </ul>
            <div class="modal-actions">
                <button class="primary" onclick="closeCatManager()">Done</button>
            </div>
        </div>
        <div id="edit-color-popup" style="display:none; position:absolute; background:var(--card-bg); padding:10px; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,0.2); border:1px solid var(--border); z-index:1100; display:flex; gap:5px; flex-wrap:wrap; width:160px;">
        </div>
    </div>

    <div id="recipe-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row">
                <h2 id="modal-title">Add Recipe</h2>
                <button class="modal-close-btn" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="import-row">
                <div style="flex-grow:1;">
                    <input type="url" id="import-url" placeholder="Paste recipe URL here..." style="width:100%; border:1px solid #ccc;">
                </div>
                <button class="btn-import" onclick="importRecipe()"><i class="fas fa-magic"></i> Auto-Fill</button>
            </div>
            <div class="form-group">
                <label>Title</label>
                <div class="input-wrapper">
                    <input type="text" id="inp-title" placeholder="e.g. Grandma's Lasagna">
                    <button class="mic-btn" onclick="toggleDictation('inp-title', this)"><i class="fas fa-microphone"></i></button>
                </div>
            </div>
            
            <div class="form-group">
                <label>Cuisine Style (Select multiple)</label>
                <div id="category-tag-container" class="tag-container">
                    </div>
            </div>

            <div class="form-group">
                <label>Ingredients (one per line)</label>
                <div class="input-wrapper">
                    <textarea id="inp-ingredients" rows="4" placeholder="2 Eggs&#10;1 cup Flour"></textarea>
                    <button class="mic-btn" onclick="toggleDictation('inp-ingredients', this)"><i class="fas fa-microphone"></i></button>
                </div>
            </div>
            <div class="form-group">
                <label>Instructions</label>
                <div class="input-wrapper">
                    <textarea id="inp-instructions" rows="6" placeholder="1. Mix ingredients...&#10;2. Bake at 350..."></textarea>
                    <button class="mic-btn" onclick="toggleDictation('inp-instructions', this)"><i class="fas fa-microphone"></i></button>
                </div>
            </div>
            <input type="hidden" id="inp-id">
            <div class="modal-actions">
                <button class="secondary" onclick="closeModal()">Cancel</button>
                <button class="primary" onclick="saveRecipe()">Save Recipe</button>
            </div>
        </div>
    </div>

    <div id="selector-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row">
                <h2>Select a Meal</h2>
                <button class="modal-close-btn" onclick="closeSelectorModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="filter-scroll" id="picker-filters"></div>
            <ul id="picker-list" class="recipe-picker-list"></ul>
            <div class="modal-actions">
                <button class="secondary" onclick="closeSelectorModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div id="cook-mode-overlay">
        <div class="cook-header">
            <h2 id="cook-title" class="cook-title">Recipe Title</h2>
            <button class="cook-close-btn" onclick="closeCookMode()"><i class="fas fa-times"></i></button>
        </div>
        <div class="cook-body">
            <div class="cook-section"><h3>Ingredients</h3><div id="cook-ingredients"></div></div>
            <div class="cook-section"><h3>Instructions</h3><div id="cook-instructions"></div></div>
        </div>
    </div>

    <div id="view-recipe-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header-row" style="align-items: flex-start;">
                <div style="flex-grow:1;">
                    <div id="view-modal-badges" class="cat-badges" style="margin-bottom:8px;"></div>
                    <h2 id="view-modal-title" class="recipe-title" style="font-size:1.8rem; color:var(--text-main);">Recipe Title</h2>
                </div>
                <button class="modal-close-btn" onclick="closeViewModal()"><i class="fas fa-times"></i></button>
            </div>
            
            <div style="display:flex; gap:10px; margin-bottom:1.5rem; border-bottom:1px solid var(--border); padding-bottom:1rem;">
                <button id="view-btn-cook" class="btn-cook" style="flex:1; justify-content:center;"><i class="fas fa-fire"></i> Start Cooking</button>
                <button id="view-btn-edit" class="btn-sm"><i class="fas fa-edit"></i> Edit</button>
                <button id="view-btn-copy" class="btn-sm"><i class="far fa-copy"></i> Copy Text</button>
                <button id="view-btn-print" class="btn-sm" onclick="printRecipe()"><i class="fas fa-print"></i> Print</button>
            </div>

            <div class="form-group">
                <label>Ingredients</label>
                <ul id="view-ingredients" style="margin-left:1.5rem; line-height:1.6; color:var(--text-main);"></ul>
            </div>
            <div class="form-group">
                <label>Instructions</label>
                <div id="view-instructions" style="line-height:1.7; color:var(--text-main);"></div>
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>

